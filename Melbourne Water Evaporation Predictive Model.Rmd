---
title: "CASE STUDY"
author: "Mark Werner"
date: "November, 2021"
output:
  pdf_document: default
  html_document: default
theme: united
toc: yes
---

\newpage



# EXECUTIVE SUMMARY

In light of recent changes to Melbourne's climate, the Melbourne Water Corporation (MWC) has requested re-evaluation of previous estimates relating to water evaporation rates at its reservoirs and have asked for a new model to be built assessing the effects of Melbourne's day-to-day weather on evaporation.

A predictive model was built using Melbourne's weather observations, including evaporation, for the previous financial year. The findings of this study suggest a relationship between temporal and meteorological factors which have been found to have a significant impact on the amount of evaporation.

The model is able to predict , on a given day, the amount of evaporation based on three predictors: the month of the year, the percentage of relative humidity (measured at 9am on the given day), and the minimum temperature in degrees Celsius (i.e., the lowest temperature recorded in the preceding 24 hours to 9am of the given day). 


## Key Findings: 

 - There is a relationship between evaporation and month of the year where colder months correspond to lower evaporation and warmer months correspond to higher evaporation.

 - A higher daily minimum temperature corresponds to a higher evaporation amount.

 - The amount of evaporation decreases as the relative humidity increases.

 - The is no relationship between evaporation amount and day of week

 - There is a relationship between maximum daily temperature and evaporation amount however the variable for maximum temperature failed to pass the statistically significant threshold in the model building process and was therefore excluded from the final model. This is outlined in detail in the 'Discussion' section.


_Note: all code used to create the model, as well as accompanying output and visualisations can be found in the 'Appendix' section._

\newpage

# METHODS 

## Cleaning

Data used to create the model was taken from the provided `melbourne.csv` file. This file contains 365 observations of 21 variables. A complete description of these variables can be found at \newline

http://www.bom.gov.au/climate/dwo/IDCJDW0000.shtml. \newline

The decision had been made that the following variables would be potentially useful influences on the amount of evaporation in a day:

 - Month,
 - Day of Week,
 - Maximum temperature in degrees Celsius,
 - Minimum temperature in degrees Celsius, and
 - Relative humidity (as measured at 9am).

Once `melbourne.csv` was read using the R-Studio software package the above variables were selected (forming a new tibble called `melbdata`). These variables were recoded to allow for data extraction and further processing. In particular, the `Date` variable required recoding to be able to extract and create two new variables `Month` and `Day of week`. Once this was done, the `Date` variable was removed as it was superfluous. The variable `9am relative humidity (%)` was recoded as an integer to assist with further processing.
Each variable was checked for missing values. The response variable `Evaporation (mm)` was found to have 8 missing values, (_NA_’s). The corresponding 8 rows of data were omitted from the dataset. \newline



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r eval = FALSE, echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
install.packages("tidyverse")

```


```{r eval = TRUE, echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, cache = TRUE}

library(readr)
setwd("C:/Users/Mark/Documents/Assessment 3")
melbourne <- read_csv("melbourne.csv")
```



```{r message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(dplyr)
library(lubridate)
#Selecting the columns I need from the dataset and recoding variables:
melbdata <- select(melbourne, "Date" : "Maximum Temperature (Deg C)", 
"9am relative humidity (%)", "Evaporation (mm)") # selecting the columns.
melbdata$Date <- ymd(melbdata$Date) # recoding as date.
melbdata$`9am relative humidity (%)` <- 
as.integer(melbdata$`9am relative humidity (%)`) # recoding to integer.
melbdata <- melbdata %>% mutate("Month" = 
month(Date, label = TRUE, abbr = TRUE)) #adding a column for "Month".
melbdata <- melbdata %>% mutate("Day of Week" = 
wday(Date, label = TRUE, abbr = FALSE)) # adding a column for "Day of Week".
melbdata <- select(melbdata, -`Date`) # removing the original date column.
inspectdf::inspect_na(melbdata) #looking for missing values.

```
The following dates corresponding to these omisssions were:

 - 03/07/2018 to 08/07/2018 inclusive (i.e., 6 days in a row), and 
 - 27/12/2018 to 28/12/2018 inclusive (i.e., 2 days in a row). 

Once these were removed, the data was checked again. The output of this can be found below 
in the section 'Summary Inspection'.

```{r include=FALSE}
melbdata<- na.omit(melbdata) # We shall remove these 8 rows of missing data for the purose of building the model, then perform a quick check:
inspectdf::inspect_na(melbdata) #looking for missing values

```

## Univariate Analysis

Each variable underwent univariate analysis by producing appropriate plots as well as summaries to ascertain each variable’s distribution (paying attention to location, shape, spread, and outliers). In each case skewness was also computed to help support the decision as to whether a transformation of a respective variable was required. Two variables, `Evaporation (mm)`, the response variable, and `Maximum Temperature (Deg C)`, a predictor variable, were transformed and renamed `evap_transf` and `maxtemp_transf` respectively.

As a final step, univariate analysis of the categorical variables as well as a summary of all variables within `melbdata` was done using the `inspectdf` function.\newline

The following pages outline this process and provide full details of summaries in each case:






\newpage

### Univariate Summary: Evaporation

Univariate analysis of Evaporation (mm):

```{r fig.cap = "Plot of variable: Evaporation (mm)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
library(ggplot2)
melbdata %>% ggplot(aes(`Evaporation (mm)`)) + 
geom_histogram(fill = "light blue", col = "black", binwidth = 0.5) + 
scale_y_continuous(breaks = round(seq(min(0), max(34), by = 2),2)) +
scale_x_continuous(breaks = round(seq(min(0), max(20), by = 1),2)) + 
labs(title = "Histogram of Evaporation (mm)", y = "Frequency") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r fig.cap = "Plot of variable: Evaporation (mm)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

melbdata %>% ggplot(aes(`Evaporation (mm)`)) + geom_boxplot(fill = "light blue", 
col = "black") + scale_x_continuous(breaks = round(seq(min(0), max(20), by = 1),2)) + 
scale_y_continuous(breaks = NULL) + labs(title = "Boxplot of Evaporation (mm)") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```



\newpage
```{r message=FALSE, warning=FALSE, echo = FALSE, paged.print=FALSE}
summary(melbdata$`Evaporation (mm)`)
library("moments")
skewness(melbdata$`Evaporation (mm)`, na.rm = TRUE)
sd(melbdata$`Evaporation (mm)`, na.rm = TRUE)
```
The mean is 5.312
The median is 4.6
The shape is multimodal, right-skewed.
Outliers can be seen beyond 13mm evaporation when observing the boxplot.\newline

Assessing the spread, the standard deviation is 3.491281. The inter quartile range
$IQR = Q_{3} - Q_{1} = 7 - 2.8 = 4.2$\newline

The skewness of the distribution for this variable is 1.328865 whichi indicates it is highly right skewed.

As such, **this distribution will be transformed using a cube root transformation:**

\newpage

### Univariate Transformation: Evaporation

```{r fig.cap = "Plot of transformed variable Evaporation (mm)", echo = FALSE}
melbdata <- melbdata %>% mutate(evap_transf = (`Evaporation (mm)`)^(1/3))
melbdata %>% ggplot(aes(evap_transf))+geom_histogram(fill = "light blue", 
col = "red", binwidth = 0.15)+ scale_y_continuous(breaks = round(seq(min(0), 
max(60), by = 5),2)) + scale_x_continuous(breaks = round(seq(min(0), max(3), by = 
0.25),2)) + labs(title = bquote("Histogram of transformed Evaporation ("*mm^{1/3}*")"), 
y = "Frequency") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
skewness(melbdata$evap_transf, na.rm = TRUE)

```
Testing the skewness of the transformed variable gives us -0.113 which indicates we have an acceptably symmetric distribution. **We will therefore use this transformed variable for our model.**


\newpage

### Univariate Summary: Minimum Temperature

Next we assess the variable "Minimum temperature (Deg C)"


```{r fig.cap = "Plot of variable Minimum temperature (Deg C)", echo = FALSE}
melbdata %>% ggplot(aes(`Minimum temperature (Deg C)`)) + geom_histogram(fill = "green", 
col = "black", binwidth = 1) + scale_y_continuous(breaks = round(seq(min(0), max(42), 
by = 2),2)) + scale_x_continuous(breaks = round(seq(min(0), max(26), by = 2),2)) + 
labs(title = "Histogram of Minimum temperature (Deg C)", x = "Deg (C)", 
y = "Frequency") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

\newpage



```{r fig.cap = "Plot of variable Minimum temperature (Deg C)", echo = FALSE}
melbdata %>% ggplot(aes(`Minimum temperature (Deg C)`)) + geom_boxplot(fill = "green", 
col = "black") + scale_x_continuous(breaks = round(seq(min(0), max(26), by = 1),2)) + 
scale_y_continuous(breaks = NULL) + labs(title = 
"Boxplot of Minimum temperature (Deg C)") + theme(plot.title = 
element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```


```{r echo = FALSE}
summary(melbdata$`Minimum temperature (Deg C)`)
skewness(melbdata$`Minimum temperature (Deg C)`)
sd(melbdata$`Minimum temperature (Deg C)`)
```

The mean is 11.83
The median is 11.4
The shape is slightly right skewed. 
Outliers are visible in the boxplot beyond 25 degrees Celsius.

Assessing the spread, the standard deviation is 4.518612. \newline
The inter quartile range is
$IQR = Q_{3} - Q_{1} = 14.8-8.6 = 6.2$

The skewness of the distribution for this variable is 0.3082482 which indicates an acceptable level of symmetry. As such we will not perform any transformation on this variable.
\newpage

### Univariate Summary: Maximum Temperature

Next we assess the variable Maximum Temperature (Deg C):

```{r fig.cap = "Plot of Maximum Temperature (Deg C)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(`Maximum Temperature (Deg C)`)) + geom_histogram(fill = 
"light grey", col = "black") + scale_y_continuous(breaks = round(seq(min(0), 
max(34), by = 2),2)) + scale_x_continuous(breaks = round(seq(min(6), max(44),
by = 2),2)) + labs(title = "Histogram of Maximum Temperature (Deg C)", x = 
"Deg (C)", y = "Frequency") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```


\newpage

```{r fig.cap = "Plot of Maximum Temperature (Deg C)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(`Maximum Temperature (Deg C)`)) + geom_boxplot(fill = 
"light grey", col = "black") + scale_x_continuous(breaks = round(seq(min(0), 
max(44), by = 2),2)) + scale_y_continuous(breaks = NULL) + labs(title = 
"Boxplot of Maximum Temperature (Deg C)", x = "Temperature (Deg C)") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```








```{r echo = FALSE}
summary(melbdata$`Maximum Temperature (Deg C)`)
skewness(melbdata$`Maximum Temperature (Deg C)`)
sd(melbdata$`Maximum Temperature (Deg C)`)
```

The mean is 20.87
The median is 20
The shape is moderately right skewed with a skewness value of 0.9236407.
Numerous outliers can be seen in the boxplot beyond 35 degrees Celsius.

Assessing the spread, the standard deviation is 6.224088. The inter quartile range is
$IQR = Q_{3} - Q_{1} = 23.9-16.2 = 7.7$

**This distribution is moderately skewed ( = 0.9236407) so will perform a cube root transform (next page):**

\newpage

### Univariate Transformation: Maximum Temperature

```{r fig.cap = "Plot of transformed variable Maximum Temperature.", echo = FALSE}
melbdata <- melbdata %>% mutate(maxtemp_transf = (`Maximum Temperature (Deg C)`)^(1/3))
melbdata %>% ggplot(aes(maxtemp_transf))+geom_histogram(fill = "light grey", col = 
"red", binwidth = 0.1)+ scale_y_continuous(breaks = round(seq(min(0), max(100), 
by = 10),2)) + scale_x_continuous(breaks = round(seq(min(2), max(4), by = 0.25),2)) + 
labs(title = "Histogram of transformed Maximum Temperature", x = 
bquote("maxtemp_transf (Deg "*C^{1/3}*")"), y = "Frequency") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
skewness(melbdata$maxtemp_transf, na.rm = TRUE)

```
Testing the skewness of the transformed variable gives us 0.4437796 which indicates we have an acceptably symmetric distribution. We will therefore use this transformed variable for our model.


\newpage

### Univariate Summary: Relative Humidity

Next we assess the variable `9am relative humidity (%)`:

```{r fig.cap = "Plot of variable 9am relative humidity (%)", echo = FALSE}
melbdata %>% ggplot(aes(`9am relative humidity (%)`)) + geom_histogram(fill = 
"light green", col = "black", binwidth = 2) + scale_y_continuous(breaks = 
round(seq(min(0), max(40), by = 2),2)) + scale_x_continuous(breaks = 
round(seq(min(30), max(100), by = 5),2)) + labs(title =
"Histogram of 9am relative humidity (%)", y = "Frequency") + theme(plot.title = 
element_text(hjust = 0.5), axis.text = element_text(size = 8), axis.title =
element_text(size = 10))
```

\newpage
```{r fig.cap = "Plot of variable 9am relative humidity (%)", echo = FALSE}
melbdata %>% ggplot(aes(`9am relative humidity (%)`)) + geom_boxplot(fill = 
"light green", col = "black") + scale_x_continuous(breaks = round(seq(min(20), 
max(100), by = 5),2)) + scale_y_continuous(breaks = NULL) + labs(title = 
"Boxplot of 9am relative humidity (%)") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```
```{r echo = FALSE}
summary(melbdata$`9am relative humidity (%)`)
skewness(melbdata$`9am relative humidity (%)`)
sd(melbdata$`9am relative humidity (%)`)
```

The mean is 68.36
The median is 68
The shape is multimodal.
Outliers are visible in the boxplot beyond the lower whisker.

Assessing the spread, the standard deviation is 13.58471. \newline 
The inter quartile range is
$IQR = Q_{3} - Q_{1} = 77 - 61 = 16$

The skewness of the distribution for this variable is -0.2736669 which indicates an acceptable level of symmetry. As such we will not perform any transformation on this variable.

\newpage


\newpage

### Summary Inspection

A summary inspection of all the variables:
```{r echo = FALSE}

inspectdf::inspect_types(melbdata)
inspectdf::inspect_num(melbdata)
inspectdf::inspect_cat(melbdata)
```




\newpage

## Bivariate Analysis

Once the univariate analysis was complete and the appropriate transformations were made, plots were produced to explore the relationships between the transformed response variable `evap_transf` and each potential predictor. \newline

Summary of Bivariate Analysis:

 - `evap_transf` & `Month`	Side-by-side boxplot (_Refer to Figure 11_)
 - `evap_transf` & `Day of Week`	Side-by-side boxplot (_Refer to Figure 12_)
 - `evap_transf` & `9am relative humidity (%)`	Scatterplot (_Refer to Figure 13_)
 - `evap_transf` & `Minimum temperature (Deg C)`	Scatterplot (_Refer to Figure 14_)
 - `evap_transf` & `maxtemp_transf`	Scatterplot (_Refer to Figure 15_)

 _Detailed interpretations of these are outlined alongside each plot._  \newline
\newpage

Producing plots to explore the relationship between the transformed response variable and each predictor:

### Bivariate Summary: Month


```{r fig.cap = "Side-by-side Box plot of Evaporation by Month", echo = FALSE}
melbdata %>% group_by(Month) %>% ggplot(aes(x = Month, y = `evap_transf`)) + 
geom_boxplot(fill = "light blue") + labs(title = 
"Boxplot of transformed Evaporation by Month", y = 
bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
scale_y_continuous(breaks = round(seq(min(0), max(3), by = 0.5),2)) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

```






Here we see a definite cyclical pattern where the amount of evaporation decreases over the colder months and increases during the hotter months. This indicates there exists a relationship between the predictor variable `Month` and the response variable `evap_transf' (in units of $mm^{1/3}$).





\newpage
### Bivariate Summary: Day of Week

```{r fig.cap = "Side-by-side Box plot of Evaporation by Day of Week", echo =FALSE}
melbdata %>% group_by(`Day of Week`) %>% ggplot(aes(x = `Day of Week`, y = 
`evap_transf`)) + geom_boxplot(fill = "Orange") + labs(title = 
"Boxplot of Transformed Evaporation by Day of Week", y = 
bquote("Transformed Evaporation ("*mm^{1/3}*")")) + scale_y_continuous(breaks = 
round(seq(min(0), max(3), by = 0.5),2)) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))



```






From observation of the boxplot we see no discernible relationship between the predictor variable `Day of Week` and the transformed response variable `evap_transf` (expressed in units of $mm^{1/3}$) where the median value for each day sits between $1.5mm^{1/3}$ and $1.75mm^{1/3}$ .\newline

\newpage
### Bivariate Summary: Minimum Temperature

```{r fig.cap = "Scatter plot of transformed Evaporation and Minimum temperature (Deg C)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, y = `evap_transf`)) + 
geom_point() + geom_smooth()+ labs(title = 
"Scatter plot of Transformed Evaporation and Minimum Temperature",
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

cor(melbdata$evap_transf, melbdata$`Minimum temperature (Deg C)`)
```
Here we see a moderate positive relationship between the transformed response variable `evap_transf` (expressed in units of $mm^{1/3}$) and the predictor variable `Minimum temperature (Deg C)`. We can see from the output that this moderate positive relationship carries a correlation coefficient value of 0.6412193.



\newpage


### Bivariate Summary: Maxiumum Temperature

```{r fig.cap = "Scatter plot of transformed Evaporation and transformed Maximum Temperature (Deg C)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `maxtemp_transf`, y = `evap_transf`)) + geom_point() + 
geom_smooth()+ labs(title = 
"Plot of Transformed Evaporation and Transformed Maximum Temperature", 
x = bquote("Transformed Maximum Temperature ("*'Deg' ~C^{1/3}*")"), 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

cor(melbdata$evap_transf,melbdata$maxtemp_transf)
```
Here we see a moderate positive relationship between the transformed response variable `evap_transf` (expressed in units of $mm^{1/3}$) and the transformed predictor variable `maxtemp_transf` (expressed in units of Deg $C^{1/3}$). We can see from the output that this moderate positive relationship carries a correlation coefficient value of 0.5957085.

\newpage

### Bivariate Summary: Relative Humidity

```{r fig.cap = "Scatterplot of transformed Evaporation and 9am Relative Humidity", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `9am relative humidity (%)`, y = `evap_transf`)) + 
geom_point() + geom_smooth() + labs(title = 
"Scatterplot of transformed Evaporation and 9am Relative Humidity", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

cor(melbdata$evap_transf,melbdata$`9am relative humidity (%)`, use = "complete.obs")
```
Here we see a moderate negative relationship between the transformed response variable `evap_transf` (expressed in units of $mm^{1/3}$) and the predictor variable `9am relative humidity (%)`. We can see from the output that this moderate negative relationship carries a correlation coefficient value of -0.5168967.

\newpage

## Trivariate Analysis

This is added as an extension to assist the reader by providing enhanced visualisation to better understand the intrinsic relationship between respective quantitative variables and month of the year. In each case we see a clear relationship between the amount of evaporation and time of year (_Refer to Figures 16, 17, and 18 over the following pages_).

### Visualisations

```{r fig.cap = "Scatter plot of transformed Evaporation and 9am Relative Humidity coloured by Month.", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE} 


ggplot(melbdata, aes(x = `9am relative humidity (%)`, y = `evap_transf`, col = `Month`)) + 
geom_point() + labs(title = 
"Transformed Evaporation and 9am Relative Humidity coloured by Month", x = 
"9am Relative Humidity (%)", y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```





\newpage

```{r fig.cap = "Scatter plot of transformed Evaporation and Minimum temperature (Deg C) coloured by Month.", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, y = `evap_transf`, col = 
`Month`)) + geom_point() + 
labs(title = "Plot of Transformed Evaporation and Min. Temp. coloured by Month",
x = "Minimum Temperature (Deg C)", y = 
bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```





\newpage

```{r fig.cap = "Scatter plot of transformed Evaporation and transformed Maximum Temperature coloured by Month.", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(melbdata, aes(x = `maxtemp_transf`, y = `evap_transf`, col = `Month`)) + 
geom_point() + labs(title = 
"Transformed Evaporation and Transformed Max. Temp. coloured by Month", 
x = bquote("Transformed Maximum Temperature ("*'Deg' ~C^{1/3}*")"), 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

```




\newpage

## Model Selection

A base linear model was built in R to predict evaporation (in mm) on a given day in Melbourne using all of the predictors listed on page 4. An interaction term between `Month` and `9am relative humidity (%)` was also included in this model to determine whether humidity has a different effect in different months. 

Using the five predictors we built a model of the following form (with the inclusion of the interaction term): \newline


$y_{i} = \beta_{0} + \beta_{1}x_{i1} + \beta_{2}x_{i2}+ \beta_{3}x_{i3}+ \beta_{4}x_{i4}+ \beta_{5}x_{i5}+ \beta_{6}x_{i1}x_{i2}+\epsilon_{i}$ \newline

**The categorical variables `Month` and `Day of Week` were recoded as unordered factors to assist with their interpretation in the summary output of the model before undertaking a dimensionality reduction process**. This iterative process involved fitting a linear model containing all the possible predictors, then determining the p-values for inclusion of each predictor. P-values for quantitative variables were determined using the linear model summary. P-values for categorical values (as well as the interaction term which contained a categorical variable) were determined using an ANOVA. The predictor with the highest p-value was removed (unless all remaining predictors were significant at the 5% level). The model was then updated to include only the remaining predictors and the process was repeated until only significant predictors remained.  
 

```{r echo = FALSE}
melbdata <-  melbdata %>% filter(Month %in% c("Jan", "Feb", "Mar", "Apr", "May", 
"Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
melbdata <- melbdata %>% mutate(Month = factor(Month, ordered = FALSE))
melbdata <-  melbdata %>% filter(`Day of Week` %in% c("Sunday", "Monday", 
"Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
melbdata <- melbdata %>% mutate(`Day of Week` = factor(`Day of Week`, ordered = FALSE))


```



### The First Iteration

```{r echo = FALSE}
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + `Day of Week` + 
`Minimum temperature (Deg C)` + maxtemp_transf + Month:`9am relative humidity (%)`,
data = melbdata)

summary(melbdata_lm)
anova(melbdata_lm)

```

From the summary output we can see that the predictor with the highest p-value is maxtemp_transf = 0.4231. This was removed from the model and the process was repeated with the remaining predictors.

\newpage

### The Second Iteration

```{r echo = FALSE}
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + 
`Day of Week` + `Minimum temperature (Deg C)` + Month:`9am relative humidity (%)`, 
data = melbdata)

summary(melbdata_lm)
anova(melbdata_lm)

```

From the ANOVA output we can see that the interaction term `Month`:`9am relative humidity (%)` has the highest p-value = 0.21521. This interaction term was removed and the process was repeated using only the remaining predictors.

\newpage

### The Third Iteration

```{r echo = FALSE}
# 3rd iteration
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + 
`Day of Week` + `Minimum temperature (Deg C)`, data = melbdata)
summary(melbdata_lm)
anova(melbdata_lm)
```
The ANOVA output shows the categorical predictor `Day of Week` has a p-value lying outside the 5% significance level = 0.05505. This was removed and the process was repeated using only the remaining predictors.

\newpage

### The Fourth Iteration

```{r echo = FALSE}
# 4th iteration
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + 
`Minimum temperature (Deg C)`, data = melbdata)
summary(melbdata_lm)
anova(melbdata_lm)

```
At the completion of this iteration, all remaining predictors were significant at the 5% level.
\newpage

### Significant Terms

Following the dimensionality reduction algorithm outlined above, the remaining predictor variables were:

 - The categorical variable Month, with a p-value < $2.2\text{ x } 10^{-16}$ (taken from the ANOVA output), where we also note that **January is set as the reference category in the summary output.** \newline
 - The quantitative variable `9am relative humidity (%)`, with a p-value < $2\text{ x } 10^{-16}$ (taken from the linear model summary output).\newline
 - The quantitative variable `Minimum temperature (Deg C)`, with a p-value of $5.49\text{ x } 10^{-12}$ (taken from the linear model summary output).

These three predictor terms all exhibited a moderate to strong correlation to the response variable as seen in the bivariate analysis. However the variable `maxtemp_transf` failed to exhibit significance at the 5% level (and therefore was not used in the final model) despite a moderate correlation with the response variable. This is due to **colinearity** which is explored and discussed in detail in the 'Results' section. 

## Model Diagnostics

In this section we tested model assumptions. Namely:

 - Linearity (_Figure 19_)
 - Normality of $\epsilon_i$’s (_Figure 20_)
 - Constant variance of $\epsilon_i$’s (_Figure 21_).
 - Independence of the error terms.

These are outlined over the following pages:
\newpage

```{r fig.cap = "Plot of Residuals vs Fitted to check for Linearity", echo = FALSE}
plot(melbdata_lm, which = 1)
```



**Linearity - checking that a straight line was the best way to model the relationship between the variables.**

We see no discernible curvature in the points as we go from left to right. The red line is overall quite straight. We also notice no trend in the residuals which is a good indication that **the assumption of linearity is satisfied.**



\newpage

```{r fig.cap = "Q-Q Plot of Residuals to check for Normality", echo = FALSE}
plot(melbdata_lm, which = 2)
```



**Normality of ${\epsilon}_{i}$'s**

Normally distributed residuals lie along the dotted line. In both instances we see points beginning to drift away from the line beyond $x=-2$ and $x=2$. Since these points drift away beyond $x=-2$ and $x=2$ we can assume that about 95% of the residuals are normally distributed as this represents two standard deviations from the mean. As such, the **normality of the error terms is upheld.**



\newpage

```{r fig.cap = "Plot of the square root of the Standardised Residuals to test for Homoscedascity", echo = FALSE}
plot(melbdata_lm, which = 3)
```



**Constant variance of ${\epsilon}_{i}$'s (i.e., homoscedascity).**


We see a relatively even spread of the points with slight condensing in the middle however no apparent trends as we move from left to right. Also, the red line is rather straight and flat. Therefore, **the constant variance assumption is upheld.**

\newpage

**Independence of the error terms.**

If we consider the fact we have a time series of meteorological values as daily observations it is clear that there exists a dependence between observations. 
The annual periodicity evident in seasonal temperatures is a function of the Earth/Sun system producing warmer and cooler months of the year in a cyclical fashion. Generally, observations made in a particular month will carry similar average conditions (e.g. temperatures) as other observations made around the same time. Furthermore, with respect to the relationship between the variables used in our model, the rate at which water evaporates from the surface of a lake is directly influenced by temperature as well as relative humidity. Higher temperatures correlate to higher evaporation rates because as temperature increases, the amount of energy necessary for evaporation decreases. As such, the loss of water by evaporation in warm weather is greater than in cool weather. Since the relative humidity is simply a measure of the water vapor content of the air, lower relative humidity means drier air, and thus, a higher evaporation rate. The more humid the air, the closer the air is to saturation, and less evaporation can occur. With respect to temperature, warm air can also hold higher concentrations of water vapour, so essentially there is more room for more water vapour to be stored in warmer air compared to colder air (Integrate Program, 2021). 

Because of these fundamental dependencies between temperature, relative humidity, and amount of water evaporation, coupled with annual cyclical temperature variations, **the independence of our respective error terms cannot be upheld.** 




\newpage

# RESULTS

As outlined in the Methods section above, the predictor variables used in the model are:

 - The categorical variable Month. \newline
 - The quantitative variable `9am relative humidity (%)`.\newline
 - The quantitative variable `Minimum temperature (Deg C)`.\newline

Therefore our model takes the form:\newline

$y_{i} = \beta_{0} + \beta_{1}x_{i1} + \beta_{2}x_{i2}+ \beta_{3}x_{i3}+\epsilon_{i}$\newline


Where 

 - $y_{i}$ is the $i^{th}$ transformed response value for evaporation (with transformed units of ($mm^{1/3}$)), 
 - $\beta_{0}$ is the intercept = 2.083995, 
 - $\beta_{1}$ is the coefficient for the $i^{th}$ month ($x_{i1}$), 
 - $\beta_{2} = -0.009784$ is the coefficient for the $i^{th}$ value of relative humidity ($x_{i2}$), and 
 - $\beta_{3} = 0.032522$ is the coefficient for the $i^{th}$ value of minimum temperature ($x_{i3}$).\newline

Putting it together we get: \newline

evap_transf = 2.083995 + $\beta_{1}$(`Month`) -0.009784(`9am relative humidity`) + 0.032522(`Minimum temperature (Deg C)`) $+\epsilon_{i}$ \newline

\newpage
The following two plots show the relationship between each quantitative predictor and the response variable for our model:

```{r fig.cap = "Plot of Minimum Temperature vs Transformed Evaporation", echo = FALSE, message=FALSE, warning=FALSE}
ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, `evap_transf`, 
col = Month))+ labs(title = "Regression Line Plot", x="Minimum temperature (Deg C)", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10)) + geom_point()+geom_smooth(aes(group = 1), 
method = lm, se = FALSE)
```




Here we see the positive linear relationship between the predictor variable `Minimum temperature (Deg C)` and the transformed response variable.

\newpage

```{r fig.cap = "Plot of Relative Humidity vs Transformed Evaporation", message=FALSE, warning=FALSE, echo=FALSE}
ggplot(melbdata, aes(x = `9am relative humidity (%)`, `evap_transf`, 
col = Month))+ labs(title = "Regression Line Plot", x="9am Relative Humidity (%)", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10)) + geom_point()+geom_smooth(aes(group = 1), 
method = lm, se = FALSE)
```



Here we can see the negative linear relationship between the predictor variable `9am Relative Humidity` and the transformed response variable.

\newpage

## Interpretation of Intercept and Slope Coefficients

The following examples aim to provide easy to understand interpretations of the intercept and coefficients relating to each predictor:\newline

 - If we set the Month = January (i.e., $\beta_1$ = 0), set relative humidity to zero, and the minimum temperature to zero then our model becomes:\newline

`evap_transf` = 2.083995 + 0 – (0.009784 $\times$ 0) + (0.032522 $\times$ 0)\newline

Which means our $x_{i1}$, $x_{i2}$ and $x_{i3}$ terms drop off leaving only the **intercept** term. Therefore, our model becomes:\newline

`evap_transf` = 2.083995\newline

Remembering this is the transformed value, so raising 2.083995 to the power of 3 gives us 9.050864. Therefore, our model predicts that with these (unlikely) conditions in January we still see approximately 9.05mm of evaporation.

 - If, for example, we pick Month = February (i.e., $\beta_1 = - 0.051789$), set relative humidity to zero, and the minimum temperature to zero then our model becomes:\newline

`evap_transf` = 2.083995 - 0.051789 – (0.009784 $\times$ 0) + (0.032522 $\times$ 0)\newline

Which means our $x_{i2}$ and $x_{i3}$ terms drop off leaving only the **Month coefficient** and **intercept** term. Therefore, our model becomes:\newline

`evap_transf` = 2.083995 - 0.051789 = 2.032206\newline

Raising 2.032206 to the power of 3 gives us 8.392729. Therefore, our model predicts that with these (also unlikely) conditions in February we still see approximately 8.39mm of evaporation.

 - Finally, if we set the Month = January (i.e., $\beta_1$ = 0), the relative humidity at 100%, and the minimum temperature to 10 Deg C we get:\newline

`evap_transf` = 2.083995 – (0.009784 $\times$ 100) + (0.032522 $\times$ 10) = 1.430815\newline

Which means we have non-zero values for our $x_{i2}$ and $x_{i3}$ **slope coefficient terms**. Raising 1.430815 to the power of 3 gives us an estimated evaporation of 2.92mm for days in January when the relative humidity at 9am is 100% and the minimum temperature (in the 24 hours to 9am) is 10 Deg C.

\newpage

**In general we can say the following with respect to the coefficients for `Minimum Temperature (Deg C)` and `9am relative humidity (%)`:**

 - The coefficient for `Minimum Temperature (Deg C)`= 0.032522 is *positive* which means that for every unit increase in the variable there is an increase in the amount of evaporation.
 - The coefficient for `9am relative humidity (%)`= -0.009784 is *negative* which means that for every unit increase in the variable there is an decrease in the amount of evaporation (i.e. an inversely proportional relationship).
 
These relationships are evident in the following bivariate plots (which are reproduced for clarity):

```{r fig.cap = "Scatter plot of transformed Evaporation and Minimum temperature (Deg C)", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, y = `evap_transf`)) + 
geom_point() + geom_smooth(col = "red")+ labs(title = 
"Scatter plot of Transformed Evaporation and Minimum Temperature",
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```



Note the positive relationship between minimum temperature and evaporation amount.

\newpage

```{r fig.cap = "Scatterplot of transformed Evaporation and 9am Relative Humidity", echo = FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `9am relative humidity (%)`, y = `evap_transf`)) + 
geom_point() + geom_smooth(col = "red") + labs(title = 
"Scatterplot of transformed Evaporation and 9am Relative Humidity", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```




Note the negative relationship between 9am relative humidity and evaporation amount.

\newpage

## Further Comments on Results

The variable `maxtemp_transf` showed a moderate correlation with the response variable however was not significant at the 5% level. It was therefore excluded from the model. The assumption here is that this is due to colinearity. This is verified with the following linear correlation matrix:

```{r, message=FALSE, echo = FALSE, warning=FALSE, paged.print=FALSE}
library(corrplot)
melbdata_df <- melbdata %>% select(`Minimum temperature (Deg C)`, 
`maxtemp_transf`,`9am relative humidity (%)`,`evap_transf`)
melbdata_df <- as.data.frame(melbdata_df)
mdf<- cor(melbdata_df, use = "complete.obs")
corrplot(mdf, method = "number")
```
Here we note a high positive correlation ($=0.71$) between `Minimum temperature (Deg C)` and `maxtemp_transf` (our transformed maximum temperature variable).\newline 

It is worth noting that if we remove the variable `Minimum temperature (Deg C)` from the model selection algorithm altogether and execute the dimensional reduction algorithm as above, then `maxtemp_transf` becomes highly significant and ends up as a predictor in the final model. This is further evidence which points to the existence of colinearity between `Minimum temperature (Deg C)` and `maxtemp_transf`, where the linear regression performed by R has placed weighted significance on `Minimum temperature (Deg C)` in this case.\newline  


\newpage

# DISCUSSION

In response to the request from Melbourne Water Company (MWC), the model was used to predict the amount of evaporation in millimeters for some specific extreme scenarios. The details are:

 - February 29, 2020, with a minimum temperature of 13.8 degrees and a maximum temperature of 23.2 degrees, and 74% humidity at 9am. 
 - December 25, 2020, with a minimum temperature of 16.4 degrees and a maximum temperature of 31.9 degrees, and 57% humidity at 9am. 
 - January 13, 2020, with a minimum temperature of 26.5 degrees and a maximum temperature of 44.3 degrees, and 35% humidity at 9am. 
 - July 6, 2020, with a minimum temperature of 6.8 degrees and a maximum temperature of 10.6 degrees, and 76% humidity at 9am. 

## Prediction

The following table lists the required attributes from the specific scenarios above relevant to the predictors in our model and provides calculated prediction intervals in each case: 

```{r include=FALSE}
#The following code produces predictions for the amount of evaporation, in mm, 
#for days with specific characteristics and stores these values respectively:

melb_model_1 <- tibble(`Month` = "Feb", `Minimum temperature (Deg C)` = 13.8, 
`9am relative humidity (%)` = 74)

melb_model_2 <- tibble(`Month` = "Dec", `Minimum temperature (Deg C)` = 16.4, 
`9am relative humidity (%)` = 57)

melb_model_3 <- tibble(`Month` = "Jan", `Minimum temperature (Deg C)` = 26.5, 
`9am relative humidity (%)` = 35)

melb_model_4 <- tibble(`Month` = "Jul", `Minimum temperature (Deg C)` = 6.8, 
`9am relative humidity (%)` = 76)


```



```{r echo = FALSE}
#Now to produce 95% prediction intervals and display in a table:

melb_model_1_pi <- c(predict(melbdata_lm, newdata = melb_model_1, interval = 
"prediction", level = 0.95))^3
melb_model_2_pi <- c(predict(melbdata_lm, newdata = melb_model_2, interval = 
"prediction", level = 0.95))^3
melb_model_3_pi <- c(predict(melbdata_lm, newdata = melb_model_3, interval = 
"prediction", level = 0.95))^3
melb_model_4_pi <- c(predict(melbdata_lm, newdata = melb_model_4, interval = 
"prediction", level = 0.95))^3
library(knitr)

Date <- c('February','December','January','July') 
MinTemp <- c(13.8,16.4,26.5,6.8)
RelHum_9am <- c(74,57,35,76)
pred_table1 <- data.frame(Date, MinTemp,RelHum_9am)
names(pred_table1)[names(pred_table1) == 'Date'] <- 'Date'
names(pred_table1)[names(pred_table1) == 'MinTemp'] <- 'Min Temp. (Deg C)'
names(pred_table1)[names(pred_table1) == 'RelHum_9am'] <- '9am Rel. Humidity (%)'


table2 <- data.frame(round(rbind(melb_model_1_pi,melb_model_2_pi,melb_model_3_pi,
melb_model_4_pi), digits = 1))
names(table2)[names(table2) == 'X1'] <- 'Fit (mm)'
names(table2)[names(table2) == 'X2'] <- 'Lower Prediction Interval (mm)'
names(table2)[names(table2) == 'X3'] <- 'Upper Prediction Interval (mm)'
rownames(table2) <-  NULL

table_1 <- cbind(pred_table1,table2) #joining the two tables together

kable(table_1, caption = "95% prediction intervals for expected 
evaporation under specific conditions for specific days")
```

Based on our model, we can say the following with respect to the prediction intervals generated for the scenarios above (making note of the fact that a specific date falls within a particular month which our model uses as the categorical predictor): 

 - On February 29, 2020, if this day has a minimum temperature of 13.8 degrees, and has 74% relative humidity at 9am, we are 95% confident the amount of evaporation will fall between 2mm and 11.3mm.

 - On December 25, 2020, if this day has a minimum temperature of 16.4 degrees, and has 57% relative humidity at 9am, we are 95% confident the amount of evaporation will fall between 3.3mm and 15mm.

 - On January 13, 2020, if this day has a minimum temperature of 26.5 degrees, and has 35% relative humidity at 9am, we are 95% confident the amount of evaporation will fall between 9.4mm and 29.7mm.

 - On July 6, 2020, if this day has a minimum temperature of 6.8 degrees, and has 76% relative humidity at 9am, we are 95% confident the amount of evaporation will fall between 0.4mm and 5.1mm.

\newpage 

## Prediction Comparison

From these predictions we can see that the day with the highest 9am relative humidity also has the lowest minimum temperature and thus produces the lowest predicted amount of evaporation. Conversely, we see the day with the highest minimum temperature having the lowest 9am relative humidity and thus the greatest predicted amount of evaporation. These contrasting results agree with our understanding of the hydrological process of evaporation as outlined on page 36. Further evidence which supports this understanding is provided by the fact that we also see greater amounts of evaporation in warmer months. 
Additionally, these contrasting examples also highlight the corresponding relationships between the quantitative predictor coefficients with the response variable in our model, where there is a proportional relationship between minimum temperature and evaporation, and an inversely proportional relationship between relative humidity and evaporation. 


## Prediction: 10mm Evaporation


If there is more than 10mm of evaporation at the reservoir, the MWC takes temporary measures to ensure continuous supply of water. As such, confidence intervals were calculated for the specific days above. This allows us to state, with 95% confidence, whether this will occur for days with the same conditions:

```{r echo = FALSE}
# Now to produce 95% confidence intervals and display in a table:

melb_model_1_ci <- c(predict(melbdata_lm, newdata = melb_model_1, interval = 
"confidence", level = 0.95))^3
melb_model_2_ci <- c(predict(melbdata_lm, newdata = melb_model_2, interval = 
"confidence", level = 0.95))^3
melb_model_3_ci <- c(predict(melbdata_lm, newdata = melb_model_3, interval = 
"confidence", level = 0.95))^3
melb_model_4_ci <- c(predict(melbdata_lm, newdata = melb_model_4, interval = 
"confidence", level = 0.95))^3
library(knitr)
# creating a basic table with information for each given date/weather scenario
Date <- c('February','December','January','July') 
MinTemp <- c(13.8,16.4,26.5,6.8)
RelHum_9am <- c(74,57,35,76)
pred_table <- data.frame(Date, MinTemp,RelHum_9am)
names(pred_table)[names(pred_table) == 'Date'] <- 'Date'
names(pred_table)[names(pred_table) == 'MinTemp'] <- 'Min Temp. (Deg C)'
names(pred_table)[names(pred_table) == 'RelHum_9am'] <- '9am Rel. Humidity (%)'


table1 <- data.frame(round(rbind(melb_model_1_ci,melb_model_2_ci,melb_model_3_ci,
melb_model_4_ci), digits = 1))
names(table1)[names(table1) == 'X1'] <- 'Fit (mm)'
names(table1)[names(table1) == 'X2'] <- 'Lower Confidence Interval (mm)'
names(table1)[names(table1) == 'X3'] <- 'Upper Confidence Interval (mm)'
rownames(table1) <-  NULL

table <- cbind(pred_table,table1) #joining the two tables together

kable(table, caption = "95% confidence intervals for expected 
evaporation under specific conditions on specific dates")



```

Using our model, and from the confidence intervals in Table 2, we can say:\newline 

 - On January 13, 2020 (and other days in January with the same conditions), if the minimum temperature is 26.5 degrees, and the relative humidity measured at 9am is 35%, the amount of evaporation will fall into the range of 15.2mm to 20.3mm 95% of the time. Therefore, we can say (with 95% confidence) that days in January with these conditions **require** temporary measures.

 - On February 29, 2020, (and other days in February with the same conditions), if the minimum temperature is 13.8 degrees, and the relative humidity measured at 9am is 74%, the amount of evaporation will fall into the range of 4.6mm to 6.3mm 95% of the time. Therefore, we can say (with 95% confidence) that days in February with these conditions **do not require** temporary measures.
 
 - On July 6, 2020, (and other days in July with the same conditions) if the minimum temperature is 6.8 degrees, and the relative humidity measured at 9am is 76%, the amount of evaporation will fall into the range of 1.5mm to 2.3mm 95% of the time. Therefore, we can say (with 95% confidence) that days in July with these conditions **do not require** temporary measures.
 
 - On December 25, 2020, (and other days in December with the same conditions) if the minimum temperature is 16.4 degrees, and the relative humidity measured at 9am is 57%, the amount of evaporation will fall into the range of 6.7mm to 8.9mm 95% of the time. Therefore, we can say (with 95% confidence) that days in December with these conditions **do not require** temporary measures.

\newpage

# CONCLUSION

This study presents an improved prediction model allowing the Melbourne Water Corporation (MWC) to accurately predict daily evaporation amounts (in mm) at the Cardinia Reservior based on three predictors: the month of the year, the percentage of relative humidity (meaasured at 9am on the given day), and the minimum temperature in degrees Celsius (i.e., the lowest temperature recorded in the preceding 24 hours to 9am of the given day). 

In formulating this model, it was determined that colder months correspond to lower evaporation amounts and warmer months correspond to higher evaporation.
Furthermore, higher daily minimum temperatures correspond to higher evaporation amounts however the amount of evaporation decreases as the relative humidity increases. These observations (as well as the resulting model behaviour) agree with the hydrological physical processes of water evaporation and the dependent relationship evaporation has on meteorological and climatic conditions. 

Another outcome of the analysis found that there is no relationship between evaporation amount and day of week. The result seems obvious, nevertheless, the statistical evidence supports this.

A relationship between maximum daily temperature and evaporation amount was discovered however the variable for maximum temperature failed to pass the statistically significant threshold in the model building process and was therefore excluded from the final model. 

It is recommended that future iterations of this model take this into account and also, due to the inherent relationship between water evaporation and temperature, further research into the viability of using  this variable as a predictor is suggested.
\newpage

# APPENDIX

## Setup Code

```{r eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
install.packages("tidyverse")

```

```{r eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE, cache = TRUE}

library(readr)
setwd("C:/Users/Mark/Documents/Assessment 3")
melbourne <- read_csv("melbourne.csv")
```

## Cleaning Code

```{r eval = FALSE, echo = TRUE,  message=FALSE, warning=FALSE, paged.print=FALSE}
library(dplyr)
library(lubridate)
#Selecting the columns I need from the dataset and recoding variables:
melbdata <- select(melbourne, "Date" : "Maximum Temperature (Deg C)", 
"9am relative humidity (%)", "Evaporation (mm)") # selecting the columns.
melbdata$Date <- ymd(melbdata$Date) # recoding as date.
melbdata$`9am relative humidity (%)` <- 
as.integer(melbdata$`9am relative humidity (%)`) # recoding to integer.
melbdata <- melbdata %>% mutate("Month" = 
month(Date, label = TRUE, abbr = TRUE)) #adding a column for "Month".
melbdata <- melbdata %>% mutate("Day of Week" = 
wday(Date, label = TRUE, abbr = FALSE)) # adding a column for "Day of Week".
melbdata <- select(melbdata, -`Date`) # removing the original date column.
inspectdf::inspect_na(melbdata) #looking for missing values.

```

```{r eval = FALSE, echo = TRUE}
melbdata<- na.omit(melbdata) # We shall remove these 8 rows of missing data for 
#the purose of building the model, then perform a quick check:
inspectdf::inspect_na(melbdata) #looking for missing values

```

## Univariate Analysis Code

```{r fig.cap = "Plot of variable: Evaporation (mm)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
library(ggplot2)
melbdata %>% ggplot(aes(`Evaporation (mm)`)) + 
geom_histogram(fill = "light blue", col = "black", binwidth = 0.5) + 
scale_y_continuous(breaks = round(seq(min(0), max(34), by = 2),2)) +
scale_x_continuous(breaks = round(seq(min(0), max(20), by = 1),2)) + 
labs(title = "Histogram of Evaporation (mm)", y = "Frequency") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r fig.cap = "Plot of variable: Evaporation (mm)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

melbdata %>% ggplot(aes(`Evaporation (mm)`)) + geom_boxplot(fill = "light blue", 
col = "black") + scale_x_continuous(breaks = round(seq(min(0), max(20), by = 1),2)) + 
scale_y_continuous(breaks = NULL) + labs(title = "Boxplot of Evaporation (mm)") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r message=FALSE, warning=FALSE, eval = FALSE, echo = TRUE, paged.print=FALSE}
summary(melbdata$`Evaporation (mm)`)
library("moments")
skewness(melbdata$`Evaporation (mm)`, na.rm = TRUE)
sd(melbdata$`Evaporation (mm)`, na.rm = TRUE)
```

```{r fig.cap = "Plot of transformed variable Evaporation (mm)", eval = FALSE, echo = TRUE}
# transformation of variable
melbdata <- melbdata %>% mutate(evap_transf = (`Evaporation (mm)`)^(1/3))
melbdata %>% ggplot(aes(evap_transf))+geom_histogram(fill = "light blue", 
col = "red", binwidth = 0.15)+ scale_y_continuous(breaks = round(seq(min(0), 
max(60), by = 5),2)) + scale_x_continuous(breaks = round(seq(min(0), max(3), by = 
0.25),2)) + labs(title = bquote("Histogram of transformed Evaporation ("*mm^{1/3}*")"), 
y = "Frequency") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
skewness(melbdata$evap_transf, na.rm = TRUE)

```

```{r fig.cap = "Plot of variable 9am relative humidity (%)", eval = FALSE, echo = TRUE}
melbdata %>% ggplot(aes(`9am relative humidity (%)`)) + geom_histogram(fill = 
"light green", col = "black", binwidth = 2) + scale_y_continuous(breaks = 
round(seq(min(0), max(40), by = 2),2)) + scale_x_continuous(breaks = 
round(seq(min(30), max(100), by = 5),2)) + labs(title =
"Histogram of 9am relative humidity (%)", y = "Frequency") + theme(plot.title = 
element_text(hjust = 0.5), axis.text = element_text(size = 8), axis.title =
element_text(size = 10))
```

```{r fig.cap = "Plot of variable 9am relative humidity (%)", eval = FALSE, echo = TRUE}
melbdata %>% ggplot(aes(`9am relative humidity (%)`)) + geom_boxplot(fill = 
"light green", col = "black") + scale_x_continuous(breaks = round(seq(min(20), 
max(100), by = 5),2)) + scale_y_continuous(breaks = NULL) + labs(title = 
"Boxplot of 9am relative humidity (%)") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r eval = FALSE, echo = TRUE}
summary(melbdata$`9am relative humidity (%)`)
skewness(melbdata$`9am relative humidity (%)`)
sd(melbdata$`9am relative humidity (%)`)
```

```{r fig.cap = "Plot of variable Minimum temperature (Deg C)", eval = FALSE, echo = TRUE}
melbdata %>% ggplot(aes(`Minimum temperature (Deg C)`)) + geom_histogram(fill = "green", 
col = "black", binwidth = 1) + scale_y_continuous(breaks = round(seq(min(0), max(42), 
by = 2),2)) + scale_x_continuous(breaks = round(seq(min(0), max(26), by = 2),2)) + 
labs(title = "Histogram of Minimum temperature (Deg C)", x = "Deg (C)", 
y = "Frequency") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r fig.cap = "Plot of variable Minimum temperature (Deg C)", eval = FALSE, echo = TRUE}
melbdata %>% ggplot(aes(`Minimum temperature (Deg C)`)) + geom_boxplot(fill = "green", 
col = "black") + scale_x_continuous(breaks = round(seq(min(0), max(26), by = 1),2)) + 
scale_y_continuous(breaks = NULL) + labs(title = 
"Boxplot of Minimum temperature (Deg C)") + theme(plot.title = 
element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```

```{r eval = FALSE, echo = TRUE}
summary(melbdata$`Minimum temperature (Deg C)`)
skewness(melbdata$`Minimum temperature (Deg C)`)
sd(melbdata$`Minimum temperature (Deg C)`)
```

```{r fig.cap = "Plot of Maximum Temperature (Deg C)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(`Maximum Temperature (Deg C)`)) + geom_histogram(fill = 
"light grey", col = "black") + scale_y_continuous(breaks = round(seq(min(0), 
max(34), by = 2),2)) + scale_x_continuous(breaks = round(seq(min(6), max(44),
by = 2),2)) + labs(title = "Histogram of Maximum Temperature (Deg C)", x = 
"Deg (C)", y = "Frequency") + theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r fig.cap = "Plot of Maximum Temperature (Deg C)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(`Maximum Temperature (Deg C)`)) + geom_boxplot(fill = 
"light grey", col = "black") + scale_x_continuous(breaks = round(seq(min(0), 
max(44), by = 2),2)) + scale_y_continuous(breaks = NULL) + labs(title = 
"Boxplot of Maximum Temperature (Deg C)", x = "Temperature (Deg C)") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
```

```{r eval = FALSE, echo = TRUE}
summary(melbdata$`Maximum Temperature (Deg C)`)
skewness(melbdata$`Maximum Temperature (Deg C)`)
sd(melbdata$`Maximum Temperature (Deg C)`)
```

```{r fig.cap = "Plot of transformed variable Maximum Temperature.", eval = FALSE, echo = TRUE}
# transformation of variable
melbdata <- melbdata %>% mutate(maxtemp_transf = (`Maximum Temperature (Deg C)`)^(1/3))
melbdata %>% ggplot(aes(maxtemp_transf))+geom_histogram(fill = "light grey", col = 
"red", binwidth = 0.1)+ scale_y_continuous(breaks = round(seq(min(0), max(100), 
by = 10),2)) + scale_x_continuous(breaks = round(seq(min(2), max(4), by = 0.25),2)) + 
labs(title = "Histogram of transformed Maximum Temperature", x = 
bquote("maxtemp_transf (Deg "*C^{1/3}*")"), y = "Frequency") + 
theme(plot.title = element_text(hjust = 0.5),
axis.text = element_text(size = 8), axis.title = element_text(size = 10))
skewness(melbdata$maxtemp_transf, na.rm = TRUE)

```

```{r eval = FALSE, echo = TRUE}

inspectdf::inspect_types(melbdata)
inspectdf::inspect_num(melbdata)
inspectdf::inspect_cat(melbdata)
```

## Bivariate Analysis Code

```{r fig.cap = "Side-by-side Box plot of Evaporation by Month", eval = FALSE, echo = TRUE}
melbdata %>% group_by(Month) %>% ggplot(aes(x = Month, y = `evap_transf`)) + 
geom_boxplot(fill = "light blue") + labs(title = 
"Boxplot of transformed Evaporation by Month", y = 
bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
scale_y_continuous(breaks = round(seq(min(0), max(3), by = 0.5),2)) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

```

```{r fig.cap = "Side-by-side Box plot of Evaporation by Day of Week", eval = FALSE, echo = TRUE}
melbdata %>% group_by(`Day of Week`) %>% ggplot(aes(x = `Day of Week`, y = 
`evap_transf`)) + geom_boxplot(fill = "Orange") + labs(title = 
"Boxplot of Transformed Evaporation by Day of Week", y = 
bquote("Transformed Evaporation ("*mm^{1/3}*")")) + scale_y_continuous(breaks = 
round(seq(min(0), max(3), by = 0.5),2)) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

```

```{r fig.cap = "Scatterplot of transformed Evaporation and 9am Relative Humidity", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `9am relative humidity (%)`, y = `evap_transf`)) + 
geom_point() + geom_smooth() + labs(title = 
"Scatterplot of transformed Evaporation and 9am Relative Humidity", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

cor(melbdata$evap_transf,melbdata$`9am relative humidity (%)`, use = "complete.obs")
```

```{r fig.cap = "Scatter plot of transformed Evaporation and Minimum temperature (Deg C)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, y = `evap_transf`)) + 
geom_point() + geom_smooth()+ labs(title = 
"Scatter plot of Transformed Evaporation and Minimum Temperature",
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

cor(melbdata$evap_transf, melbdata$`Minimum temperature (Deg C)`)
```

```{r fig.cap = "Scatter plot of transformed Evaporation and transformed Maximum Temperature (Deg C)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `maxtemp_transf`, y = `evap_transf`)) + geom_point() + 
geom_smooth()+ labs(title = 
"Plot of Transformed Evaporation and Transformed Maximum Temperature", 
x = bquote("Transformed Maximum Temperature ("*'Deg' ~C^{1/3}*")"), 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

cor(melbdata$evap_transf,melbdata$maxtemp_transf)
```

## Trivariate Analysis Code

```{r fig.cap = "Scatter plot of transformed Evaporation and 9am Relative Humidity coloured by Month.", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE} 


ggplot(melbdata, aes(x = `9am relative humidity (%)`, y = `evap_transf`, col = `Month`)) + 
geom_point() + labs(title = 
"Transformed Evaporation and 9am Relative Humidity coloured by Month", x = 
"9am Relative Humidity (%)", y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```

```{r fig.cap = "Scatter plot of transformed Evaporation and Minimum temperature (Deg C) coloured by Month.", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, y = `evap_transf`, col = 
`Month`)) + geom_point() + 
labs(title = "Plot of Transformed Evaporation and Min. Temp. coloured by Month",
x = "Minimum Temperature (Deg C)", y = 
bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```

```{r fig.cap = "Scatter plot of transformed Evaporation and transformed Maximum Temperature coloured by Month.", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(melbdata, aes(x = `maxtemp_transf`, y = `evap_transf`, col = `Month`)) + 
geom_point() + labs(title = 
"Transformed Evaporation and Transformed Max. Temp. coloured by Month", 
x = bquote("Transformed Maximum Temperature ("*'Deg' ~C^{1/3}*")"), 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))

```

## Model Selection Code

```{r eval = FALSE, echo = TRUE}
# making sure to recode categorical variables as unordered factors

melbdata <-  melbdata %>% filter(Month %in% c("Jan", "Feb", "Mar", "Apr", "May", 
"Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))
melbdata <- melbdata %>% mutate(Month = factor(Month, ordered = FALSE))
melbdata <-  melbdata %>% filter(`Day of Week` %in% c("Sunday", "Monday", 
"Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"))
melbdata <- melbdata %>% mutate(`Day of Week` = factor(`Day of Week`, ordered = FALSE))

```

```{r eval = FALSE, echo = TRUE}
# 1st iteration
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + `Day of Week` + 
`Minimum temperature (Deg C)` + maxtemp_transf + Month:`9am relative humidity (%)`,
data = melbdata)

summary(melbdata_lm)
anova(melbdata_lm)

```

```{r eval = FALSE, echo = TRUE}
# 2nd iteration
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + 
`Day of Week` + `Minimum temperature (Deg C)` + Month:`9am relative humidity (%)`, 
data = melbdata)

summary(melbdata_lm)
anova(melbdata_lm)

```

```{r eval = FALSE, echo = TRUE}
# 3rd iteration
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + 
`Day of Week` + `Minimum temperature (Deg C)`, data = melbdata)
summary(melbdata_lm)
anova(melbdata_lm)

```

```{r eval = FALSE, echo = TRUE}
# 4th iteration
melbdata_lm <- lm(evap_transf ~ `Month` + `9am relative humidity (%)` + 
`Minimum temperature (Deg C)`, data = melbdata)
summary(melbdata_lm)
anova(melbdata_lm)

```

## Model Diagnostics Code

```{r fig.cap = "Plot of Residuals vs Fitted to check for Linearity", eval = FALSE, echo = TRUE}
plot(melbdata_lm, which = 1)
```

```{r fig.cap = "Q-Q Plot of Residuals to check for Normality", eval = FALSE, echo = TRUE}
plot(melbdata_lm, which = 2)
```

```{r fig.cap = "Plot of the square root of the Standardised Residuals to test for Homoscedascity", eval = FALSE, echo = TRUE}
plot(melbdata_lm, which = 3)
```

```{r fig.cap = "Plotting residuals over time to check for Idependence", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(x = Date, y = `Minimum temperature (Deg C)`)) + 
geom_line() + geom_smooth()
```

```{r fig.cap = "Plotting residuals over time to check for Idependence", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(x = Date, y = `evap_transf`)) + geom_line() + geom_smooth()
```

```{r fig.cap = "Plotting residuals over time to check for Idependence", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(x = Date, y = `9am relative humidity (%)`)) + geom_line() +
geom_smooth()
```

```{r fig.cap = "Plotting residuals by Month to check for Idependence", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(x = Month, y = `Minimum temperature (Deg C)`)) + geom_point()
```

```{r fig.cap = "Plotting residuals by Month to check for Idependence", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
melbdata %>% ggplot(aes(x = Month, y = `evap_transf`)) + geom_point()

```

## Results Code

```{r fig.cap = "Plot of Minimum Temperature vs Transformed Evaporation", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE}
ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, `evap_transf`, 
col = Month))+ labs(title = "Regression Line Plot", x="Minimum temperature (Deg C)", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10)) + geom_point()+geom_smooth(aes(group = 1), 
method = lm, se = FALSE)
```

```{r fig.cap = "Plot of Relative Humidity vs Transformed Evaporation", message=FALSE, warning=FALSE, eval = FALSE, echo = TRUE}
ggplot(melbdata, aes(x = `9am relative humidity (%)`, `evap_transf`, 
col = Month))+ labs(title = "Regression Line Plot", x="9am Relative Humidity (%)", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10)) + geom_point()+geom_smooth(aes(group = 1), 
method = lm, se = FALSE)
```

```{r, message=FALSE, eval = FALSE, echo = TRUE, warning=FALSE, paged.print=FALSE}
library(corrplot)
melbdata_df <- melbdata %>% select(`Minimum temperature (Deg C)`, 
`maxtemp_transf`,`9am relative humidity (%)`,`evap_transf`)
melbdata_df <- as.data.frame(melbdata_df)
mdf<- cor(melbdata_df, use = "complete.obs")
corrplot(mdf, method = "number")
```

```{r fig.cap = "Scatter plot of transformed Evaporation and Minimum temperature (Deg C)", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
ggplot(melbdata, aes(x = `Minimum temperature (Deg C)`, y = `evap_transf`)) + 
geom_point() + geom_smooth(col = "red")+ labs(title = 
"Scatter plot of Transformed Evaporation and Minimum Temperature",
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```

```{r fig.cap = "Scatterplot of transformed Evaporation and 9am Relative Humidity", eval = FALSE, echo = TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}

ggplot(melbdata, aes(x = `9am relative humidity (%)`, y = `evap_transf`)) + 
geom_point() + geom_smooth(col = "red") + labs(title = 
"Scatterplot of transformed Evaporation and 9am Relative Humidity", 
y = bquote("Transformed Evaporation ("*mm^{1/3}*")")) +
theme(plot.title = element_text(hjust = 0.5), axis.text = element_text(size = 8), 
axis.title = element_text(size = 10))
```

## Discussion (Prediction) Code

```{r eval = FALSE, echo = TRUE}
#The following code produces predictions for the amount of evaporation, in mm, 
#for days with specific characteristics and stores these values respectively:

melb_model_1 <- tibble(`Month` = "Feb", `Minimum temperature (Deg C)` = 13.8, 
`9am relative humidity (%)` = 74)

melb_model_2 <- tibble(`Month` = "Dec", `Minimum temperature (Deg C)` = 16.4, 
`9am relative humidity (%)` = 57)

melb_model_3 <- tibble(`Month` = "Jan", `Minimum temperature (Deg C)` = 26.5, 
`9am relative humidity (%)` = 35)

melb_model_4 <- tibble(`Month` = "Jul", `Minimum temperature (Deg C)` = 6.8, 
`9am relative humidity (%)` = 76)


```

```{r eval = FALSE, echo = TRUE}
#Now to produce 95% prediction intervals and display in a table:

melb_model_1_pi <- c(predict(melbdata_lm, newdata = melb_model_1, interval = 
"prediction", level = 0.95))^3
melb_model_2_pi <- c(predict(melbdata_lm, newdata = melb_model_2, interval = 
"prediction", level = 0.95))^3
melb_model_3_pi <- c(predict(melbdata_lm, newdata = melb_model_3, interval = 
"prediction", level = 0.95))^3
melb_model_4_pi <- c(predict(melbdata_lm, newdata = melb_model_4, interval = 
"prediction", level = 0.95))^3
library(knitr)

Date <- c('February','December','January','July') 
MinTemp <- c(13.8,16.4,26.5,6.8)
RelHum_9am <- c(74,57,35,76)
pred_table1 <- data.frame(Date, MinTemp,RelHum_9am)
names(pred_table1)[names(pred_table1) == 'Date'] <- 'Date'
names(pred_table1)[names(pred_table1) == 'MinTemp'] <- 'Min Temp. (Deg C)'
names(pred_table1)[names(pred_table1) == 'RelHum_9am'] <- '9am Rel. Humidity (%)'


table2 <- data.frame(round(rbind(melb_model_1_pi,melb_model_2_pi,melb_model_3_pi,
melb_model_4_pi), digits = 1))
names(table2)[names(table2) == 'X1'] <- 'Fit (mm)'
names(table2)[names(table2) == 'X2'] <- 'Lower Prediction Interval (mm)'
names(table2)[names(table2) == 'X3'] <- 'Upper Prediction Interval (mm)'
rownames(table2) <-  NULL

table_1 <- cbind(pred_table1,table2) #joining the two tables together

kable(table_1, caption = "95% prediction intervals for expected 
evaporation under specific conditions for specific days")
```


```{r eval = FALSE, echo = TRUE}
# Now to produce 95% confidence intervals and display in a table:

melb_model_1_ci <- c(predict(melbdata_lm, newdata = melb_model_1, interval = 
"confidence", level = 0.95))^3
melb_model_2_ci <- c(predict(melbdata_lm, newdata = melb_model_2, interval = 
"confidence", level = 0.95))^3
melb_model_3_ci <- c(predict(melbdata_lm, newdata = melb_model_3, interval = 
"confidence", level = 0.95))^3
melb_model_4_ci <- c(predict(melbdata_lm, newdata = melb_model_4, interval = 
"confidence", level = 0.95))^3
library(knitr)
# creating a basic table with information for each given date/weather scenario
Date <- c('February','December','January','July') 
MinTemp <- c(13.8,16.4,26.5,6.8)
RelHum_9am <- c(74,57,35,76)
pred_table <- data.frame(Date, MinTemp,RelHum_9am)
names(pred_table)[names(pred_table) == 'Date'] <- 'Date'
names(pred_table)[names(pred_table) == 'MinTemp'] <- 'Min Temp. (Deg C)'
names(pred_table)[names(pred_table) == 'RelHum_9am'] <- '9am Rel. Humidity (%)'


table1 <- data.frame(round(rbind(melb_model_1_ci,melb_model_2_ci,melb_model_3_ci,
melb_model_4_ci), digits = 1))
names(table1)[names(table1) == 'X1'] <- 'Fit (mm)'
names(table1)[names(table1) == 'X2'] <- 'Lower Confidence Interval (mm)'
names(table1)[names(table1) == 'X3'] <- 'Upper Confidence Interval (mm)'
rownames(table1) <-  NULL

table <- cbind(pred_table,table1) # joining the two tables together

kable(table, caption = "95% confidence intervals for expected 
evaporation under specific conditions on specific dates")



```


## References

Integrate Program, 2021, Evaporation and Climate. [online] Available at: 
< <https://serc.carleton.edu/integrate/teaching_materials/food_supply/student_materials/905> > 
[Accessed 3 December 2021].

